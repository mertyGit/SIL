<!DOCTYPE html>

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>display.c</title><link rel="stylesheet" type="text/css" href="../styles/main.css" /><script type="text/javascript" src="../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="About_displays"></a><a name="Topic86"></a><div class="CTopic TGroup LC first">
 <div class="CTitle">About displays</div>
</div>

<a name="Driving_the_display"></a><a name="Topic54"></a><div class="CTopic TInformation LC">
 <div class="CTitle">Driving the display</div>
 <div class="CBody"><p>A <b>display</b> is anything that is able to output a self-constructed image with pixels and to get events like mouse of touch back from it. So it can be a &quot;real&quot; touchscreen display, but also a single window of an operating system. Since the combination of operating systems, hardware and used libraries is different, each environment do have its own ..display.c file, but do have the same functions exposed to the rest of SIL. All function calls that are specific for that environment do only live inside that file, to make the rest of SIL as portable as possible.&nbsp; You could see them as crude display drivers...</p><p>Because timers are very operating system and/or library dependend, those functions are also included. In some cases, ..display.c files do have more then the standaard functions described here, but use those at your own risk and they are not portable to other environments..</p><p>Be aware that information in events are as close to what is really possible. For instance, a touchscreen will never send MOUSEWHEEL or BUTTON_RIGHT event, because most touchscreens can only register a single touch. They can't send KEY_xxx event either, since there is no keyboard.&nbsp; Some send the latest update of mousecursor for every event, even non-mouse events, some don't, so the only thing we can do is send the last coordinates we know, and the list goes on...</p><p>These are the environments that can be build, by setting the &quot;DEST&quot; value in the makefile, or if you use something else, use the -DSIL_TARGET_xxxxx macro when compiling:</p><pre class="CText">Environment      │ DEST in Makefile │ -DSIL_TARGET_xxx  │ ...display.c file<br />═════════════════╪══════════════════╪═══════════════════╪════════════════════<br />Windows native   │ gdi              │ SIL_TARGET_GDI    │ winGDIdisplay.c<br />using GDI        │                  │                   │<br />─────────────────┼──────────────────┼───────────────────┼────────────────────<br />Windows using    │ winsdl           │ SIL_TARGET_WINSDL │ SDLdisplay.c<br />SDL2             │                  │                   │<br />─────────────────┼──────────────────┼───────────────────┼────────────────────<br />Linux using      │ lnxsdl           │ SIL_TARGET_LNXSDL │ SDLdisplay.c<br />SDL2             │                  │                   │<br />─────────────────┼──────────────────┼───────────────────┼────────────────────<br />Mac OSX using    │ macsdl           │ SIL_TARGET_MACSDL │ SDLdisplay.c<br />SDL2             │                  │                   │<br />─────────────────┼──────────────────┼───────────────────┼────────────────────<br />Linux using      │ x11              │ SIL_TARGET_X11    │ x11display.c<br />X11 / Xlib       │                  │                   │<br />─────────────────┼──────────────────┼───────────────────┼────────────────────<br />Linux/rpi using  │ fb               │ SIL_TARGET_FB     │ lnxFBdisplay.c<br />framebuffer +    │                  │                   │<br />touchscreen      │                  │                   │<br />─────────────────┼──────────────────┼───────────────────┼────────────────────</pre><p>It isn't that hard to write your own display &quot;driver&quot;. If you know how to put a pixel on the display, or even better, a complete image, create a SIL framebuffer with the dimensons, including colorcoding and pixeldepth, of the display at init and within sil_updateDisplay, call layersToFB to fill this framebuffer with all the pixels of all layers. After that you can send the image out the way you want.</p><p>The easiest way to start, is to take lnxFBdisplay.c as &quot;skeleton&quot; and build around it.</p></div>
</div>

<a name="Handling_display"></a><a name="Topic95"></a><div class="CTopic TGroup LC">
 <div class="CTitle">Handling display</div>
</div>

<a name="sil_getTypefromDisplay"></a><a name="Topic89"></a><div class="CTopic TFunction LC">
 <div class="CTitle">sil_getTypefromDisplay</div>
 <div id="NDPrototype89" class="NDPrototype"><div class="PSection PPlainSection">UINT sil_getTypefromDisplay()</div></div>
 <div class="CBody"><p>Retrieves the &quot;native&quot; RGB type for display.</p><div class="CHeading">Returns</div><p>RGB type, see <a href="../index.html#File:sil.h:RGB_types" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,18);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >RGB types</a> for more information about the possible types.</p><div class="CHeading">Remarks</div><p>Usually the less conversion SIL has to do from layers to final framebuffer, the faster, easier and less memory consuming it can be. So, when creating layers on your own, it is the best to use the same RGB type as display, hence this function to retrieve it.</p><p>Keep in mind that display RGB type might not support alpha, but layers can still make use of it.</p></div>
</div>

<a name="sil_initDisplay"></a><a name="Topic93"></a><div class="CTopic TFunction LC">
 <div class="CTitle">sil_initDisplay</div>
 <div id="NDPrototype93" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">UINT sil_initDisplay(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first"><span class="SHKeyword">void</span>&nbsp;</td><td class="PSymbols">*</td><td class="PName last">hI,</td></tr><tr><td class="PType first">UINT&nbsp;</td><td></td><td class="PName last">width,</td></tr><tr><td class="PType first">UINT&nbsp;</td><td></td><td class="PName last">height,</td></tr><tr><td class="PType first"><span class="SHKeyword">char</span>&nbsp;</td><td class="PSymbols">*</td><td class="PName last">title</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div></div>
 <div class="CBody"><p>Initialize display.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">hI<div class="CDLParameterType"><span class="SHKeyword">void</span>*</div></td><td class="CDLDefinition"><p>Only for windows+GDI: hInstance of WinMain Call, ignored for others</p></td></tr><tr><td class="CDLEntry">width<div class="CDLParameterType">UINT</div></td><td class="CDLDefinition"><p>Width of &quot;display&quot;, only if display dimensions are variable, like a window</p></td></tr><tr><td class="CDLEntry">height<div class="CDLParameterType">UINT</div></td><td class="CDLDefinition"><p>Height of &quot;display&quot;, only if display dimensions are variable, like a window</p></td></tr><tr><td class="CDLEntry">title<div class="CDLParameterType"><span class="SHKeyword">char</span>*</div></td><td class="CDLDefinition"><p>If &quot;display&quot; is a window, the title of the window will be set to this</p></td></tr></table><div class="CHeading">Remarks</div><ul><li><p>Only for reference, don't call this function directly, it is called via <a href="../index.html#File:sil.c:sil_initSIL" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,3);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >sil_initSIL()</a>.</p></li><li><p>Compile SDL width flag DSL_MAIN_HANDLED, and it doesn't require passing hInstance..</p></li></ul></div>
</div>

<a name="sil_updateDisplay"></a><a name="Topic94"></a><div class="CTopic TFunction LC">
 <div class="CTitle">sil_updateDisplay</div>
 <div id="NDPrototype94" class="NDPrototype"><div class="PSection PPlainSection"><span class="SHKeyword">void</span> sil_updateDisplay()</div></div>
 <div class="CBody"><p>Update Display with latest layer information</p><div class="CHeading">Remarks</div><ul><li><p>It's better to &quot;batch&quot; updates on layers, like drawing, moving and so on, together before calling sil_updateDisplay. This will save costly time.</p></li><li><p>A lot of SIL functions do call sil_updateDisplay themselves. When processing a handler call, you can tell SIL to update display by returning a positive value</p></li></ul></div>
</div>

<a name="sil_destroyDisplay"></a><a name="Topic15"></a><div class="CTopic TFunction LC">
 <div class="CTitle">sil_destroyDisplay</div>
 <div id="NDPrototype15" class="NDPrototype"><div class="PSection PPlainSection"><span class="SHKeyword">void</span> sil_destroyDisplay()</div></div>
 <div class="CBody"><p>Destroy display information and frees memory</p><div class="CHeading">Remarks</div><ul><li><p>Only for reference, don't call this function directly, it is called via <a href="../index.html#File:sil.c:sil_destroySIL" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,10);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >sil_destroySIL()</a>.</p></li></ul></div>
</div>

<a name="sil_getEventDisplay"></a><a name="Topic97"></a><div class="CTopic TFunction LC">
 <div class="CTitle">sil_getEventDisplay()</div>
 <div id="NDPrototype97" class="NDPrototype"><div class="PSection PPlainSection">SILEVENT *sil_getEventDisplay()</div></div>
 <div class="CBody"><p>Get event from display</p><div class="CHeading">Returns</div><p>Pointer to event structure:</p><table class="CDefinitionList"><tr><td class="CDLEntry">type</td><td class="CDLDefinition"><p>Type of event</p></td></tr><tr><td class="CDLEntry">val</td><td class="CDLDefinition"><p>More information about event, like which mouse button is pressed</p></td></tr><tr><td class="CDLEntry">x,y</td><td class="CDLDefinition"><p>(last known) position of mouse at that moment</p></td></tr><tr><td class="CDLEntry">dx,dy</td><td class="CDLDefinition"><p>If mouse is moved, difference between last known position and current.</p></td></tr><tr><td class="CDLEntry">code</td><td class="CDLDefinition"><p>'native' keycode for keyevents (in case of windows: &quot;virtual keycode&quot;)</p></td></tr><tr><td class="CDLEntry">key</td><td class="CDLDefinition"><p>keycode translated to 'common' SIL keycodes (see <a href="../index.html#File:sil.h:Keyboard_codes" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,23);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >keyboard codes</a>)</p></td></tr><tr><td class="CDLEntry">modifiers</td><td class="CDLDefinition"><p>Flags of modifiers, joined together with or, see <a href="../index.html#File:sil.h:Key_modifiers" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,92);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Key modifiers</a></p></td></tr></table><p>See, <a href="../index.html#File:layer.c:sil_setHoverHandler" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,25);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >sil_setHoverHandler()</a> , <a href="../index.html#File:layer.c:sil_setClickHandler" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,26);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >sil_setClickHandler()</a> , <a href="../index.html#File:layer.c:sil_setDragHandler" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,17);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >sil_setDragHandler()</a> for mouse/touch events, <a href="../index.html#File:layer.c:sil_setKeyHandler" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,22);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >sil_setKeyHandler()</a> for keyevents, and <a href="../index.html#File:sil.c:sil_setTimerHandler" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,7);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >sil_setTimerHandler()</a> for timer events.</p><div class="CHeading">Remarks</div><ul><li><p>This call is blocking until event comes in.</p></li><li><p>To prevent blocking forever, you can set a timer (via <a href="../index.html#File:sil.c:sil_setTimerHandler" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,7);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >sil_setTimerHandler()</a> and <a href="../index.html#File:sil.c:sil_setTimeval" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,19);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >sil_setTimeval()</a>, which will create an event on its own, or use a seperate thread to handle other things.</p></li><li><p><a href="../index.html#File:sil.c:sil_mainLoop" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,5);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >sil_mainLoop()</a> will keep calling this function and dispatching events until <a href="../index.html#File:sil.c:sil_quitLoop" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,4);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >sil_quitLoop()</a>.</p></li><li><p>Some event cannot be handled by program, but will be handled by operating system, like alt+F4 and closing the window</p></li><li><p>Keep in mind that x,y coordinates are <b>ints and can be negative</b>. Although it seems illogical, mouse pointer can go outside boundaries of &quot;display&quot;, like pressing button inside window, but releasing it outside the window.</p></li><li><p>Note that keycodes are -trying to- refferring to the pressed key, not the ascii or unicode code that is printed on it. To figure out if 'a' or 'A' is typed , check for keycode 'a' + modifiers &quot;Shift&quot; or just get the 'val', where we let the OS trying to translate keycode to ascii.</p></li></ul></div>
</div>

<a name="Timers"></a><a name="Topic102"></a><div class="CTopic TGroup LC">
 <div class="CTitle">Timers</div>
</div>

<a name="sil_setTimerDisplay"></a><a name="Topic98"></a><div class="CTopic TFunction LC">
 <div class="CTitle">sil_setTimerDisplay</div>
 <div id="NDPrototype98" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">void</span> sil_setTimerDisplay(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first">UINT&nbsp;</td><td class="PName last">amount</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div></div>
 <div class="CBody"><p>Set timer with given amount of milliseconds</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">amount<div class="CDLParameterType">UINT</div></td><td class="CDLDefinition"><p>Milliseconds before timer goes off</p></td></tr></table><div class="CHeading">Remarks</div><ul><li><p>Only for reference, don't call this function directly, it is called via <a href="../index.html#File:sil.c:sil_setTimeval" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,19);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >sil_setTimeval()</a></p></li></ul></div>
</div>

<a name="sil_stopTimerDisplay"></a><a name="Topic99"></a><div class="CTopic TFunction LC">
 <div class="CTitle">sil_stopTimerDisplay</div>
 <div id="NDPrototype99" class="NDPrototype"><div class="PSection PPlainSection"><span class="SHKeyword">void</span> sil_stopTimerDisplay()</div></div>
 <div class="CBody"><p>Stop running timer</p><div class="CHeading">Remarks</div><ul><li><p>Only for reference, don't call this function directly, it is called via <a href="../index.html#File:sil.c:sil_setTimeval" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,19);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >sil_setTimeval()</a> when amount=0 or within <a href="../index.html#File:sil.c:sil_setTimerHandler" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,7);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >sil_setTimerHandler()</a> when handler is removed.</p></li></ul></div>
</div>

<a name="Mouse"></a><a name="Topic103"></a><div class="CTopic TGroup LC">
 <div class="CTitle">Mouse</div>
</div>

<a name="sil_getMouse"></a><a name="Topic90"></a><div class="CTopic TFunction LC">
 <div class="CTitle">sil_getMouse</div>
 <div id="NDPrototype90" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">BYTE sil_getMouse(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first"><span class="SHKeyword">int</span>&nbsp;</td><td class="PSymbols">*</td><td class="PName last">x,</td></tr><tr><td class="PType first"><span class="SHKeyword">int</span>&nbsp;</td><td class="PSymbols">*</td><td class="PName last">y</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div></div>
 <div class="CBody"><p>Retrieves the latest coordinates of the mousepointer and status of mouse buttons</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">x<div class="CDLParameterType"><span class="SHKeyword">int</span>*</div></td><td class="CDLDefinition"><p>Pointer to int for returning x coordinate, or NULL if not needed</p></td></tr><tr><td class="CDLEntry">y<div class="CDLParameterType"><span class="SHKeyword">int</span>*</div></td><td class="CDLDefinition"><p>Pointer to int for returning y coordinate, or NULL if not needed</p></td></tr></table><div class="CHeading">Returns</div><p>x,y coordinates (if pointer is not NULL) and single BYTE containing MOUSE_BTN flags, see <a href="../index.html#File:sil.h:Mouse_codes" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,88);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Mouse codes</a>.</p><div class="CHeading">Remarks</div><p>It depends on environment if it is able to retrieve the &quot;real&quot; coordinates, or just use the &quot;last known location by SIL&quot;. For instance, it doesn't make sense when using a touchscreen or pencil that isn't on the display the whole time.</p></div>
</div>

<a name="sil_setCursor"></a><a name="Topic100"></a><div class="CTopic TFunction LC last">
 <div class="CTitle">sil_setCursor</div>
 <div id="NDPrototype100" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">void</span> sil_setCursor(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first">BYTE&nbsp;</td><td class="PName last">type</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div></div>
 <div class="CBody"><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">type<div class="CDLParameterType">BYTE</div></td><td class="CDLDefinition"><p>Mousecursor type (see <a href="../index.html#File:sil.h:Mouse_cursors" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,91);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Mouse Cursors</a>)</p></td></tr></table></div>
</div>

</body></html>